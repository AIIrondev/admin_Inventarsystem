<!--
   Copyright 2025 Maximilian GrÃ¼ndinger

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>{% block title %}Admin Inventarsystem{% endblock %}</title>
    {% block head %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        /* Fit-content utilities and safe defaults */
        html { box-sizing: border-box; }
        *, *::before, *::after { box-sizing: inherit; }

        /* Ensure page can grow with content on all devices */
        body { min-height: 100svh; }

        /* Keep containers centered and responsive without overflow */
        .container:not(.container-fluid) {
            width: min(100% - 2rem, 1200px);
            margin-inline: auto;
        }

        /* Utilities to size elements to their natural content */
        .fit-content        { width: fit-content; max-width: 100%; }
        .fit-content-height { height: fit-content; max-height: 100%; }

        /* Prevent horizontal overflow from long words/URLs */
        :where(p, h1, h2, h3, h4, h5, h6, li) { overflow-wrap: anywhere; word-break: normal; }

        /* Media scales within containers */
        img, video, canvas, svg { max-width: 100%; height: auto; }

        /* Tables: optionally wrap in .table-wrap and use .table-fit on table */
        .table-wrap { max-width: 100%; overflow-x: auto; }
        table.table-fit { width: max-content; max-width: 100%; border-collapse: collapse; }
        table.table-fit th, table.table-fit td { padding: .5rem .75rem; text-align: left; }

        /* Form controls avoid stretching beyond container */
        input, select, textarea, button { max-width: 100%; width: fit-content; }

        /* Global styles */
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
            padding-bottom: 30px;
        }
        
        .container {
            padding-top: 20px;
        }
        
        /* Navigation styles */
        .navbar {
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .navbar-brand {
            font-weight: bold;
            font-size: 1.4rem;
        }
        
        .admin-nav-section {
            margin-left: auto;
            display: flex;
            gap: 15px;
        }

        .admin-nav-section .nav-item {
            background-color: #28a745;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .admin-nav-section .nav-item:hover {
            background-color: #218838;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        /* Admin dropdown styling */
        .nav-item.dropdown .nav-link.dropdown-toggle {
            color: #ffffff;
            font-weight: 500;
            position: relative;
        }
        
        .nav-item.dropdown .nav-link.dropdown-toggle:hover {
            color: #ffffff;
        }
        
        /* Consistent spacing for admin nav items */
        .navbar-nav .nav-item {
            margin-right: 5px;
        }

        .navbar-nav {
           align-items: center;
        }
       
        .navbar-nav .nav-item:last-child {
            margin-right: 0;
        }
        
        /* Flash messages */
        .flashes {
            margin-top: 20px;
            margin-bottom: 20px;
        }
        
        .flash {
            padding: 12px 20px;
            margin-bottom: 15px;
            border-radius: 5px;
            font-weight: 500;
        }
        
        .flash.success {
            background-color: #d4edda;
            color: #155724;
            border-left: 5px solid #28a745;
        }
        
        .flash.error {
            background-color: #f8d7da;
            color: #721c24;
            border-left: 5px solid #dc3545;
        }
        
        .flash.info {
            background-color: #e2e3e5;
            color: #383d41;
            border-left: 5px solid #6c757d;
        }
        
        /* Dropdown menus - consistent with system design */
        .dropdown-menu {
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 8px 0;
            min-width: 200px;
            margin-top: 5px;
        }
        
        .dropdown-item {
            padding: 10px 16px;
            font-size: 0.9rem;
            color: #495057;
            transition: all 0.2s ease;
            border: none;
            background: none;
        }
        
        .dropdown-item:hover,
        .dropdown-item:focus {
            background-color: #f8f9fa;
            color: #007bff;
            transform: translateX(2px);
        }
        
        /* Navigation dropdown specific styles */
        .nav-item.dropdown .dropdown-toggle {
            position: relative;
            transition: all 0.2s ease;
        }
        
        .nav-item.dropdown .dropdown-toggle:hover {
            background-color: rgba(255,255,255,0.1);
            border-radius: 4px;
        }
        
        .nav-item.dropdown .dropdown-toggle::after {
            transition: transform 0.2s ease;
        }
        
        .nav-item.dropdown.show .dropdown-toggle::after {
            transform: rotate(180deg);
        }
        
        /* User account dropdown specific styles */
        .dropdown-menu-end {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .dropdown-divider {
            margin: 6px 0;
            border-color: #dee2e6;
        }
        
        /* Version display */
        .text-info {
            opacity: 0.8;
        }

        /* Logout button styling */
        .logout-btn {
            border-radius: 999px;
            padding: .375rem .85rem;
            font-weight: 600;
            letter-spacing: .015em;
            line-height: 1.25;
        }
        @media (prefers-reduced-motion: no-preference) {
            .logout-btn {
                transition: transform .12s ease, box-shadow .2s ease, background-color .2s ease, border-color .2s ease, color .2s ease;
            }
            .logout-btn:hover { transform: translateY(-1px); box-shadow: 0 6px 16px rgba(220,53,69,.25); }
            .logout-btn:active { transform: translateY(0); box-shadow: 0 3px 10px rgba(220,53,69,.25); }
        }
        .navbar-dark .logout-btn.btn-outline-danger {
            color: #ffc9ce; border-color: rgba(220,53,69,.6);
        }
        .navbar-dark .logout-btn.btn-outline-danger:hover {
            color: #fff; background-color: rgba(220,53,69,.9); border-color: rgba(220,53,69,1);
        }
        
        /* Mobile responsive navigation styles */
        @media screen and (max-width: 768px) {
            .navbar-nav .dropdown-menu {
                border: none;
                box-shadow: none;
                background-color: rgba(52, 58, 64, 0.95);
                margin-left: 15px;
                margin-top: 5px;
                border-radius: 6px;
            }
            
            .navbar-nav .dropdown-item {
                color: #ffffff;
                padding: 12px 20px;
                font-size: 0.9rem;
            }
            
            .navbar-nav .dropdown-item:hover,
            .navbar-nav .dropdown-item:focus {
                background-color: rgba(255,255,255,0.1);
                color: #ffffff;
                transform: none;
            }
            
            .nav-item.dropdown .dropdown-toggle {
                padding: 8px 12px;
            }
            
            /* Better touch targets for mobile */
            .dropdown-toggle::after {
                margin-left: 8px;
            }
            
            /* Account dropdown stays light theme on mobile */
            .dropdown-menu-end {
                background-color: #ffffff;
                border: 1px solid #dee2e6;
            }
            
            .dropdown-menu-end .dropdown-item {
                color: #495057;
            }
            
            .dropdown-menu-end .dropdown-item:hover {
                background-color: #f8f9fa;
                color: #007bff;
            }

            
        }
    </style>
    {% endblock %}
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="{{ url_for('home') }}">Inventarsystem</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('home') }}">Home</a>
                    </li>
                    {% if 'username' in session %}
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('backup') }}">Backup</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('version') }}">Version</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logs') }}">Logs</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('config') }}">Config</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('user_managment') }}">User</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('help') }}">Help</a>
                    </li>
                    {% endif %}
                </ul>
                <div class="d-flex ms-auto">
                    {% if 'username' in session %}
                        <a id="logout" class="btn btn-outline-danger btn-sm logout-btn" href="{{ url_for('logout') }}" aria-label="Logout">Logout</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </nav>
    <div class="container">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="flashes">
                    {% for category, message in messages %}
                        <div class="flash {{ category }}">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
    </div>
    <!-- Mobile compatibility scripts -->
    <script src="{{ url_for('static', filename='js/mobile_compatibility.js') }}"></script>
    <script src="{{ url_for('static', filename='js/ios_fixes.js') }}"></script>
</body>
</html>
